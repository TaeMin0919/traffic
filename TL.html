
TABLES: SFLIGHT.

TYPES BEGIN OF T_FLIGHT.
INCLUDE TYPE SFLIGHT.
TYPES LIGHT TYPE C LENGTH 2.
TYPES END OF T_FLIGHT.

DATA: GV_SUBRC TYPE SY-SUBRC,
      OK_CODE  TYPE SY-UCOMM.

DATA: GS_LIST TYPE T_FLIGHT,
      GT_LIST LIKE TABLE OF GS_LIST.

DATA: GV_CONT TYPE REF TO CL_GUI_CUSTOM_CONTAINER,
      GV_GRID TYPE REF TO CL_GUI_ALV_GRID.

DATA: GS_LAYO TYPE LVC_S_LAYO,
      GT_SORT TYPE LVC_T_SORT,
      GS_SORT TYPE LVC_S_SORT.

DATA: GS_VAR  TYPE DISVARIANT.

SELECTION-SCREEN BEGIN OF BLOCK B1.
SELECT-OPTIONS: S_CAR FOR GS_LIST-CARRID.
PARAMETERS: P_VAR TYPE DISVARIANT-VARIANT MATCHCODE OBJECT CFB_H_PREF_LAYOUT.
SELECTION-SCREEN END OF BLOCK B1.

START-OF-SELECTION.

  SELECT *
    FROM SFLIGHT
    INTO CORRESPONDING FIELDS OF TABLE GT_LIST
    WHERE CARRID IN S_CAR.

LOOP AT GT_LIST ASSIGNING FIELD-SYMBOL(<fs>).
  IF <fs>-CONNID < 10.
     <fs>-LIGHT = 1.
  ELSEIF <fs>-CONNID < 100.
         <fs>-LIGHT = 2.
  ELSE.
         <fs>-LIGHT = 3.
  ENDIF.
ENDLOOP.


PROCESS BEFORE OUTPUT.
 MODULE STATUS_0100.
 MODULE CREATE_ALV.

PROCESS AFTER INPUT.
 MODULE USER_COMMAND_0100.
 MODULE EXIT AT EXIT-COMMAND.





MODULE USER_COMMAND_0100 INPUT.

  CASE OK_CODE.
    WHEN 'BACK'.
      LEAVE TO SCREEN 0.
  ENDCASE.

ENDMODULE.



MODULE EXIT INPUT.

  CASE OK_CODE.
    WHEN 'CANC'.
      LEAVE TO SCREEN 0.
    WHEN 'EXIT'.
      LEAVE PROGRAM.
  ENDCASE.

ENDMODULE.




MODULE CREATE_ALV OUTPUT.

  IF GV_CONT IS INITIAL.
    CREATE OBJECT GV_CONT
      EXPORTING
        CONTAINER_NAME = 'CONT'.
    CREATE OBJECT GV_GRID
      EXPORTING
        I_PARENT = GV_CONT.
  ENDIF.

  GS_VAR-REPORT = SY-CPROG.
  GS_VAR-VARIANT = P_VAR.

  GS_LAYO-ZEBRA = 'X'.
  GS_LAYO-CWIDTH_OPT = 'X'.
  GS_LAYO-EXCP_FNAME = 'LIGHT'.

  GS_SORT-FIELDNAME = 'CARRID'.
  APPEND GS_SORT TO GT_SORT.


  CALL METHOD GV_GRID->SET_TABLE_FOR_FIRST_DISPLAY
    EXPORTING
*      I_BUFFER_ACTIVE               =
*      I_BYPASSING_BUFFER            =
*      I_CONSISTENCY_CHECK           =
       I_STRUCTURE_NAME              = 'SFLIGHT'
       IS_VARIANT                    = GS_VAR
       I_SAVE                        = 'A'
*      I_DEFAULT                     = 'X'
       IS_LAYOUT                     = GS_LAYO
*      IS_PRINT                      =
*      IT_SPECIAL_GROUPS             =
*      IT_TOOLBAR_EXCLUDING          =
*      IT_HYPERLINK                  =
*      IT_ALV_GRAPHICS               =
*      IT_EXCEPT_QINFO               =
*      IR_SALV_ADAPTER               =
    CHANGING
       IT_OUTTAB                     = GT_LIST
*      IT_FIELDCATALOG               =
       IT_SORT                       = GT_SORT
*      IT_FILTER                     =
*    EXCEPTIONS
*      INVALID_PARAMETER_COMBINATION = 1
*      PROGRAM_ERROR                 = 2
*      TOO_MANY_LINES                = 3
*      OTHERS                        = 4
          .
  IF SY-SUBRC <> 0.
*   Implement suitable error handling here
  ENDIF.


ENDMODULE.